package math;

import base.BaseTest;
import math.dataType.matrix.Matrix;
import math.dataType.matrix.MatrixType;
import math.dataType.vector.Vector;
import org.junit.Test;

import java.util.List;
import static math.dataType.matrix.Matrix.emptyMatrix;
import static org.junit.Assert.assertEquals;

public class MathUtilityTest extends BaseTest
{
    private static final AbstractMathUtility MATH = MathUtil.getInstance();

    @Test
    public void test()
    {
        var query = createMatrix(new float[][]
                {{ 2.8859e-01f,  1.9000e+00f, -2.7324e-01f, -9.6486e-01f,  9.2760e-01f,
                        4.8566e+00f,  9.2407e-01f, -1.5195e+00f,  2.1219e+00f,  1.5487e+00f,
                        1.7042e+00f,  1.0228e+00f,  8.3325e-01f,  1.0906e+00f, -1.5818e+00f,
                        3.6423e-01f, -4.3875e-01f,  2.3401e-01f,  1.3833e+00f, -7.8981e-02f,
                        -9.1782e-01f,  1.3251e-01f,  2.9251e-01f, -3.6088e+00f, -1.9470e+00f,
                        5.0241e-01f,  3.4152e-01f, -2.5142e+00f, -2.2713e+00f,  1.1174e+00f,
                        -7.1020e-01f, -5.1851e-01f,  3.2210e+00f, -8.9480e-01f, -3.6820e+00f,
                        4.0517e+00f,  9.3913e-02f,  1.7312e+00f, -6.7051e-01f, -5.0262e-01f,
                        -7.0706e-01f, -3.9022e+00f, -1.7591e+00f,  1.0799e+00f,  1.3756e+00f,
                        1.0282e+00f,  1.2153e-01f,  1.7992e+00f, -2.4109e+00f, -4.0612e-01f,
                        8.5441e-01f, -3.5226e+00f,  1.7307e+00f,  2.2425e+00f, -2.4065e+00f,
                        -8.9398e-01f,  4.5557e-01f, -9.9037e-01f,  1.0124e+00f,  2.9383e-01f,
                        4.6375e-01f,  1.7480e-01f,  2.7576e-01f,  8.7637e-01f, -1.4521e-01f,
                        2.5947e+00f, -4.8475e-01f,  1.0329e+00f, -4.7796e+00f,  3.1275e+00f,
                        -3.0342e+00f, -1.1655e+00f,  6.9066e-01f,  2.4804e+00f, -2.0134e+00f,
                        -6.3795e-01f, -2.3034e-01f, -1.1245e+00f,  2.2432e-01f, -2.2818e-01f,
                        1.8645e+00f, -1.0768e+00f, -1.2342e+00f,  1.2913e-01f, -1.7383e+00f,
                        1.7718e+00f, -1.7798e-01f, -2.4415e+00f, -1.9379e+00f, -2.1038e+00f,
                        3.4273e-01f,  4.9853e-01f,  3.1336e-01f,  1.4444e+00f,  2.1244e-01f,
                        2.2583e-02f,  9.0041e-01f, -1.5275e+00f,  1.9253e+00f,  3.8822e+00f,
                        -2.1446e+00f, -8.8262e-01f,  1.7442e+00f, -1.7515e-02f, -1.1039e+00f,
                        1.2384e+01f, -6.9517e-01f,  1.0172e+00f, -2.2159e+00f, -5.7249e-01f,
                        2.5630e+00f,  3.1988e+00f,  2.9279e-01f, -1.3133e+00f,  6.3212e+00f,
                        -1.4478e+00f,  2.1289e+00f, -4.1164e-01f,  9.9479e-01f,  2.2116e+00f,
                        1.5029e+00f, -2.2751e-01f, -2.1190e-01f, -3.0701e+00f, -8.3848e-01f,
                        5.7144e+00f,  9.1442e-02f, -2.3926e-02f, -2.1493e-01f, -1.1462e+00f,
                        2.4615e-01f,  1.6905e+00f, -1.6963e+00f,  4.0003e-01f, -7.4729e-01f,
                        2.0404e+00f,  1.1330e+00f, -3.4792e+00f,  3.8386e+00f, -1.3585e+00f,
                        7.6003e-01f, -5.2385e-01f, -2.6942e+00f, -1.4570e+00f,  6.7542e-01f,
                        2.2380e-01f, -4.4961e-01f, -3.1948e-01f,  3.1352e-01f, -1.3685e+00f,
                        -2.5298e+00f,  8.8287e-01f, -3.7890e-01f, -1.3269e+00f,  2.2927e+00f,
                        -1.4229e+00f, -1.6793e+00f, -3.9996e-01f,  1.1178e+00f, -1.2308e+00f,
                        2.8907e-01f,  1.0028e+00f,  1.0714e+00f,  4.6188e-01f,  3.8772e-01f,
                        -1.6079e+00f, -1.2267e-01f,  1.1625e+00f,  1.9575e-01f, -2.2216e-02f,
                        4.3160e-01f, -2.7922e-01f, -6.2074e-01f, -2.1934e+00f, -2.4702e+00f,
                        7.9599e-01f,  5.2967e-01f,  2.0711e+00f, -1.6225e+00f,  8.5697e-01f,
                        -1.8541e+00f, -2.9432e-01f,  1.3860e+00f, -2.0613e+00f,  3.8665e+00f,
                        9.8367e-02f, -1.4998e+00f,  7.1260e-01f, -8.4408e-01f, -1.3029e+00f,
                        6.9166e-01f, -1.7001e+00f,  4.1707e+00f, -1.3847e+00f, -3.4493e-01f,
                        1.4854e+00f, -1.1610e+00f,  6.5397e-01f, -2.9998e+00f,  2.1240e+00f,
                        1.7765e+00f,  6.3834e-01f, -2.2590e+00f, -1.4247e+00f,  1.7231e+00f,
                        5.9351e-01f,  1.5116e+00f,  7.2764e-01f,  4.8578e-01f,  2.6313e+00f,
                        -1.8159e+00f, -2.1352e+00f, -2.1850e+00f, -1.5913e+00f,  7.9335e-01f,
                        2.6085e-01f,  7.3610e-01f,  1.0258e+00f, -5.2723e-01f, -1.9147e+00f,
                        -1.2487e+00f, -1.1540e+00f,  4.8292e-01f,  1.1182e+00f,  1.9889e+00f,
                        -7.7603e-01f, -2.4974e+00f,  1.1882e+00f, -2.3580e+00f,  3.1042e-01f,
                        1.2235e+00f,  1.3033e+00f, -1.8652e+00f,  1.8820e+00f,  1.0574e-01f,
                        1.9772e+00f,  1.2351e+00f, -6.4804e-01f, -2.1543e+00f,  2.2198e+00f,
                        -8.3831e+00f, -1.2936e+00f,  1.1372e+00f, -1.2521e+00f,  2.2477e+00f,
                        1.0065e+00f, -1.9644e+00f, -2.5089e+00f,  2.2778e+00f, -7.6962e-01f,
                        1.7560e+00f, -2.5616e+00f, -3.7291e-01f, -1.2047e+00f, -3.2309e-02f,
                        -8.4734e+00f},
                        { 2.6059e+00f,  3.4527e+00f,  7.6842e-01f, -2.7278e+00f,  7.2034e-01f,
                                -3.1466e-01f, -7.5081e-01f,  9.1679e-02f, -1.1590e+00f,  3.5764e+00f,
                                2.2208e+00f, -1.0179e+00f,  6.0421e-01f,  1.2101e+00f, -1.0333e-03f,
                                -2.2280e-03f,  5.3216e-01f,  3.9216e-01f,  2.2613e+00f, -1.1651e-01f,
                                -2.3247e-01f,  2.1714e+00f, -3.7449e-01f, -7.4094e+00f,  5.5556e-01f,
                                3.3000e+00f,  2.9376e-01f,  6.6810e-01f,  8.0062e-02f,  4.4206e-01f,
                                -3.5463e-01f, -1.0900e+00f, -1.8911e-01f, -2.5301e-01f, -1.3640e+00f,
                                8.5773e-01f,  1.0381e+00f,  1.1686e+00f, -2.1185e-01f, -1.5240e+00f,
                                -1.0168e+00f, -1.4985e+00f, -4.6843e+00f,  2.8255e-01f,  4.3324e-01f,
                                1.5972e+00f, -1.1325e+00f,  3.5350e-01f,  1.0334e+00f,  1.6155e-01f,
                                4.8754e-01f, -3.1008e-01f, -1.2354e+00f, -3.7231e-01f, -1.8523e-01f,
                                4.2705e-01f,  1.0323e+00f,  7.0292e-02f, -9.0553e-03f, -3.2215e-01f,
                                1.2872e+00f,  5.3177e-01f, -1.0622e+00f,  2.6142e-01f,  4.6537e-01f,
                                -1.8368e-01f, -1.4363e+00f,  2.7462e-01f, -3.2976e-01f,  1.4652e+00f,
                                1.9713e-01f, -8.3712e-02f, -5.0482e-01f,  8.7584e-01f,  9.1298e-01f,
                                4.2976e-01f,  2.5489e+00f,  1.7024e+00f, -8.6002e-01f, -7.0899e-01f,
                                3.1548e+00f,  4.8715e-01f, -1.4340e+00f, -6.4797e-01f, -1.5849e+00f,
                                1.4508e-01f,  1.2833e+00f,  4.2436e-01f, -4.2224e-01f,  6.7298e-01f,
                                1.1809e+00f,  3.2343e-01f, -6.2594e-01f,  8.8601e-01f,  2.9321e-01f,
                                -2.2967e-01f,  5.1578e-01f,  1.1767e+00f, -6.8531e-02f, -7.5404e-01f,
                                9.3267e-01f,  2.0836e+00f,  1.2839e+00f, -1.9361e+00f, -1.1005e-02f,
                                1.6024e+01f, -7.1244e-01f,  7.3626e-01f,  1.9885e+00f, -6.8431e-01f,
                                9.2730e-01f,  4.4823e-01f,  8.8506e-01f,  2.2393e-01f, -2.9744e-01f,
                                2.0677e+00f,  1.4704e-01f,  6.5818e-01f, -3.7919e-01f,  2.4105e-02f,
                                -1.5710e+00f, -6.8605e-01f,  2.3701e-01f,  2.0598e+00f,  3.9981e-01f,
                                3.9213e+00f, -1.3970e+00f, -7.4694e-01f, -2.4914e+00f, -1.7653e+00f,
                                8.8075e-01f, -2.9380e+00f,  1.0442e+00f, -1.7752e+00f, -4.9153e+00f,
                                2.5969e-01f,  2.5144e+00f, -1.0980e+00f, -1.5710e-01f,  6.1416e-02f,
                                -6.3175e-02f, -7.0474e-01f,  5.2304e-01f, -5.2689e+00f,  8.2333e-01f,
                                1.2047e+00f, -1.4524e+00f, -2.0210e-01f,  1.2079e-01f, -8.2799e-01f,
                                -1.7538e+00f,  1.5593e+00f, -1.5790e+00f, -1.6814e+00f,  3.6724e-02f,
                                -2.2907e+00f,  2.7810e-01f,  2.7110e-01f,  8.5048e-01f, -3.6792e+00f,
                                -9.9641e-01f, -1.4678e+00f, -1.2377e+00f, -1.4289e+00f,  3.2342e+00f,
                                -8.6879e-01f,  6.2455e-01f,  1.6057e+00f, -8.6454e-01f, -6.1754e-01f,
                                6.3925e-01f,  1.2081e-01f, -4.3627e-01f, -4.3165e-01f,  7.9130e-02f,
                                -6.0547e-01f, -1.7112e-01f,  5.4637e-01f, -1.0569e+00f, -1.4001e+00f,
                                -3.6957e-01f,  8.9198e-01f, -7.0115e-01f, -5.6797e-01f, -1.5251e+00f,
                                -9.4024e-01f,  7.9811e-02f, -2.8945e-01f,  1.0540e+00f,  1.3310e+00f,
                                3.5590e+00f,  1.9252e-01f,  1.9154e+00f,  9.2806e-02f,  3.2622e-02f,
                                -5.6610e-01f, -1.0068e+00f,  2.5320e-02f, -1.4234e+00f,  1.3033e+00f,
                                -3.5195e-01f,  2.1593e-01f,  1.1605e+00f,  1.5402e+00f, -1.9887e-01f,
                                -1.9757e-02f,  4.8504e+00f, -3.2871e-02f,  1.3277e-01f, -4.3629e-01f,
                                -1.0444e+00f,  2.2148e-01f,  1.1962e+00f, -1.9724e-01f,  3.0483e+00f,
                                -4.1171e-01f,  8.6374e-01f, -8.1380e-01f, -1.6163e+00f, -1.2089e+00f,
                                1.2398e+00f, -5.2386e-01f, -4.7072e-04f,  9.8831e-01f, -7.2020e-01f,
                                5.4787e-01f, -6.9935e-01f,  1.3190e+00f, -5.3437e-01f, -1.6848e+00f,
                                2.5481e-01f, -8.3449e-02f,  1.3861e+00f,  3.5791e+00f, -9.1444e-01f,
                                1.3134e-04f,  1.7922e+00f, -1.4871e-01f, -2.8281e-01f,  5.4340e-01f,
                                -1.6346e-01f,  2.0579e+00f, -4.9026e-01f, -1.7691e+00f,  9.3545e-01f,
                                8.0281e-01f, -7.0760e-01f, -3.9244e-01f,  1.0268e+00f,  1.3545e+00f,
                                -5.3537e-01f, -4.1754e-01f, -6.9929e-01f, -2.6199e+00f,  3.9523e-01f,
                                -6.5493e+00f},
                        { 4.4515e+00f,  3.6712e+00f,  1.0598e+00f,  8.1453e-01f, -1.2397e+00f,
                                2.3801e-02f,  1.9664e+00f,  5.5826e-02f, -3.1036e+00f,  3.8629e+00f,
                                2.5694e+00f, -6.5011e-01f,  1.9575e+00f, -1.7840e-02f, -7.9408e-01f,
                                1.7031e+00f,  2.7991e-01f, -2.1050e+00f,  1.7924e+00f, -5.6879e-02f,
                                -2.6630e-01f,  1.2667e+00f, -3.1021e-01f, -6.8739e+00f,  1.3282e-01f,
                                3.1595e+00f,  9.1091e-01f,  2.1796e+00f, -2.0386e+00f,  3.9155e-01f,
                                8.6340e-01f, -1.1893e+00f, -8.9416e-01f,  9.9773e-01f, -3.6225e-01f,
                                -1.6919e-01f,  2.3146e-01f,  1.0326e+00f, -1.0223e+00f,  1.4145e+00f,
                                -6.3155e-01f,  5.8572e-01f, -4.0019e+00f, -7.6874e-02f, -6.7230e-01f,
                                9.0770e-01f, -1.1182e+00f,  1.1510e+00f,  1.6114e-01f,  5.1449e-01f,
                                -6.5208e-01f, -3.8988e-01f,  1.3529e+00f, -5.0568e-01f, -8.5835e-01f,
                                -9.2976e-01f, -2.2649e+00f,  7.5764e-01f,  2.1968e-01f,  4.8692e-01f,
                                2.5040e+00f,  1.7690e+00f, -1.1287e+00f, -2.2486e+00f, -8.5422e-01f,
                                1.2778e+00f, -1.9678e+00f, -1.4986e+00f, -1.0252e+00f,  1.1131e+00f,
                                -1.0218e+00f, -2.6204e-01f,  8.9612e-01f,  4.3979e-01f, -6.6364e-01f,
                                -2.1551e+00f,  1.1268e+00f, -4.3274e-01f, -9.4358e-01f, -9.2297e-01f,
                                3.6183e-01f,  9.1208e-02f, -2.1139e-01f, -2.8240e-01f,  2.0607e+00f,
                                2.5925e-01f,  8.2069e-01f,  2.1724e+00f,  1.5155e+00f,  2.8385e-01f,
                                3.1296e-01f, -1.0258e+00f,  2.2074e+00f, -7.2619e-01f, -1.6301e-01f,
                                -2.4080e-01f,  6.1087e-01f,  1.6130e-01f, -6.8847e-01f, -1.4856e+00f,
                                -3.3405e-01f,  2.6641e+00f, -1.1738e+00f,  2.2768e-01f, -3.7914e-01f,
                                1.5583e+01f, -5.9767e-01f, -6.0452e-01f,  9.5075e-01f,  2.8456e-01f,
                                1.0586e-01f,  7.9711e-01f,  1.6698e-01f,  2.0224e-01f, -1.5739e+00f,
                                -1.7032e+00f,  4.3967e-01f,  2.4745e-01f,  8.1012e-01f,  1.1432e+00f,
                                -1.2891e+00f,  8.8840e-01f,  6.8421e-01f, -3.6711e-01f, -6.4887e-03f,
                                3.9094e+00f,  1.3983e+00f, -1.9570e+00f,  5.0182e-01f,  1.3307e+00f,
                                1.8350e+00f, -3.9199e+00f,  9.1615e-01f, -2.3788e+00f, -6.4672e+00f,
                                3.2378e-01f,  4.7491e-01f,  7.0408e-01f, -3.8827e-01f,  5.8135e-01f,
                                -4.9778e-02f, -7.6129e-01f, -4.0672e-02f, -4.5491e+00f, -6.2471e-01f,
                                6.8669e-01f,  1.0363e+00f, -1.7772e+00f,  7.4279e-01f, -2.6896e-01f,
                                -5.8723e-01f, -3.9215e-01f,  1.6389e+00f, -7.0288e-01f,  2.3582e+00f,
                                -1.3325e+00f,  1.8841e+00f, -6.3023e-02f,  6.8199e-01f, -3.4107e+00f,
                                9.2445e-01f, -7.9854e-01f, -1.0943e+00f,  3.8643e-01f,  2.5048e+00f,
                                7.9646e-01f, -2.0082e+00f, -1.5108e+00f,  1.2008e+00f, -9.5589e-01f,
                                -1.2263e+00f, -5.2315e-01f,  3.9651e-01f, -6.2385e-01f,  1.0165e+00f,
                                1.4003e-01f, -2.9687e-01f,  3.9212e-01f, -2.1009e-01f,  8.2874e-01f,
                                -1.2538e+00f,  7.3045e-01f,  3.4482e-01f, -1.7339e+00f,  1.5004e+00f,
                                -7.5565e-01f, -1.7087e-01f,  3.7564e-01f, -6.3746e-01f,  2.3158e-01f,
                                2.1630e+00f, -9.7233e-02f,  1.2617e+00f, -1.2645e+00f, -6.1587e-01f,
                                8.4847e-01f,  6.7377e-01f,  1.0446e+00f,  4.3709e-01f, -2.8166e-01f,
                                8.5484e-01f, -9.2035e-01f, -6.6637e-01f, -1.1089e+00f,  8.0081e-01f,
                                1.0920e+00f,  5.4208e+00f, -1.0228e+00f,  1.7395e+00f, -8.0612e-01f,
                                -3.2305e-01f,  1.6410e-01f,  5.8427e-02f,  1.3576e+00f,  2.8913e+00f,
                                3.9425e-02f, -6.2186e-01f, -1.3979e-01f, -3.0319e-01f,  1.7271e-01f,
                                -6.7636e-01f, -7.0570e-01f, -1.1303e+00f, -1.0530e+00f,  8.3666e-01f,
                                -7.8646e-01f, -5.9526e-02f, -7.2996e-01f,  3.1929e-01f, -1.7743e+00f,
                                3.4569e-01f,  1.2433e+00f,  2.0907e-01f,  3.7860e+00f, -4.1408e-01f,
                                1.2848e-01f,  8.5464e-02f,  2.2678e-01f, -9.3725e-01f, -8.3059e-01f,
                                1.5092e+00f,  1.1379e+00f, -9.5252e-01f, -5.0557e-01f,  3.9482e-01f,
                                1.1346e+00f,  5.0504e-02f, -3.2235e-01f,  8.3389e-02f,  8.8670e-02f,
                                5.4731e-01f, -1.2937e+00f,  4.7175e-01f,  2.9417e-01f,  1.3616e+00f,
                                -6.7828e+00f},
                        { 1.9829e+00f,  1.1259e+00f, -7.1112e-01f,  3.3919e+00f, -1.5316e+00f,
                                1.5468e+00f,  5.4768e+00f, -1.3803e-01f, -2.8789e+00f,  2.9941e+00f,
                                2.4524e+00f, -8.3902e-01f,  1.8063e+00f,  2.7465e-01f, -7.2720e-01f,
                                3.1220e+00f,  4.6031e-01f, -2.2137e+00f,  1.4454e+00f,  3.9295e-01f,
                                -4.3334e-01f,  1.2948e+00f, -1.8395e-01f, -6.6743e+00f, -1.5918e-01f,
                                3.2322e+00f,  5.3841e-01f,  2.3476e+00f, -2.2710e+00f,  3.9634e-01f,
                                7.7907e-01f, -8.1660e-01f, -9.8199e-01f,  1.0676e+00f, -2.6625e-01f,
                                -1.9975e-01f,  4.3157e-02f,  9.7456e-01f, -8.8985e-01f,  1.5031e+00f,
                                -6.9804e-01f,  6.3492e-01f, -3.9375e+00f, -5.3097e-02f, -6.8842e-01f,
                                9.3147e-01f, -1.1545e+00f,  1.1455e+00f,  1.7045e-01f,  5.0273e-01f,
                                -6.4608e-01f, -4.1087e-01f,  1.3823e+00f, -5.2168e-01f, -8.6525e-01f,
                                -8.9646e-01f, -2.2912e+00f,  7.7004e-01f,  2.2229e-01f,  4.8149e-01f,
                                2.5123e+00f,  1.7660e+00f, -1.1536e+00f, -2.2474e+00f, -8.6679e-01f,
                                1.2895e+00f, -1.9624e+00f, -1.5054e+00f, -1.0302e+00f,  1.1058e+00f,
                                -1.0246e+00f, -2.6034e-01f,  8.9129e-01f,  4.4460e-01f, -6.6038e-01f,
                                -2.1501e+00f,  1.1234e+00f, -4.3702e-01f, -9.6337e-01f, -9.1949e-01f,
                                3.5632e-01f,  9.3579e-02f, -2.1051e-01f, -2.8281e-01f,  2.0606e+00f,
                                2.5625e-01f,  8.1475e-01f,  2.1723e+00f,  1.5166e+00f,  2.8408e-01f,
                                3.1343e-01f, -1.0261e+00f,  2.2083e+00f, -7.2531e-01f, -1.6171e-01f,
                                -2.3967e-01f,  6.1003e-01f,  1.6204e-01f, -6.8842e-01f, -1.4851e+00f,
                                -3.3429e-01f,  2.6654e+00f, -1.1740e+00f,  2.2693e-01f, -3.7926e-01f,
                                1.5581e+01f, -5.9747e-01f, -6.0458e-01f,  9.5071e-01f,  2.8447e-01f,
                                1.0621e-01f,  7.9739e-01f,  1.6650e-01f,  2.0190e-01f, -1.5737e+00f,
                                -1.7031e+00f,  4.3958e-01f,  2.4720e-01f,  8.1011e-01f,  1.1433e+00f,
                                -1.2891e+00f,  8.8839e-01f,  6.8413e-01f, -3.6692e-01f, -6.5516e-03f,
                                3.9094e+00f,  1.3981e+00f, -1.9562e+00f,  4.0169e+00f,  3.7390e+00f,
                                1.9962e+00f, -2.1269e+00f, -1.7451e-01f, -1.8075e+00f, -3.9618e+00f,
                                2.9816e-01f, -1.2530e+00f,  2.5403e+00f,  8.5921e-01f,  2.3805e-01f,
                                7.5579e-01f, -7.1024e-01f, -3.2157e-01f, -3.7212e+00f, -5.0669e-01f,
                                4.6629e-02f,  1.4824e+00f, -1.7341e+00f,  6.5945e-01f,  1.4820e-02f,
                                -6.3815e-01f, -1.6906e+00f,  1.6365e+00f, -1.7281e-01f,  2.4700e+00f,
                                -1.0075e+00f,  1.5963e+00f, -1.4074e-02f,  7.7693e-01f, -3.5186e+00f,
                                8.3056e-01f, -7.0238e-01f, -1.1216e+00f,  3.7155e-01f,  2.5151e+00f,
                                8.6652e-01f, -2.0703e+00f, -1.4227e+00f,  1.1634e+00f, -9.2394e-01f,
                                -1.4196e+00f, -5.2609e-01f,  3.6782e-01f, -5.8776e-01f,  9.7497e-01f,
                                1.7906e-01f, -2.9163e-01f,  4.0709e-01f, -2.2787e-01f,  8.1854e-01f,
                                -1.2214e+00f,  7.1912e-01f,  3.2712e-01f, -1.7514e+00f,  1.4599e+00f,
                                -7.4301e-01f, -1.6747e-01f,  3.8258e-01f, -6.0401e-01f,  2.5352e-01f,
                                2.1499e+00f, -1.2139e-01f,  1.2531e+00f, -1.2525e+00f, -6.3289e-01f,
                                8.3637e-01f,  6.6607e-01f,  1.0524e+00f,  4.3044e-01f, -2.8324e-01f,
                                8.5986e-01f, -9.1804e-01f, -6.6960e-01f, -1.1187e+00f,  8.0556e-01f,
                                1.0903e+00f,  5.4174e+00f, -1.0259e+00f,  1.7407e+00f, -8.0585e-01f,
                                -3.2363e-01f,  1.6338e-01f,  6.3313e-02f,  1.3581e+00f,  2.8930e+00f,
                                4.3576e-02f, -6.1916e-01f, -1.3932e-01f, -3.0270e-01f,  1.7124e-01f,
                                -6.7342e-01f, -7.0660e-01f, -1.1305e+00f, -1.0533e+00f,  8.3727e-01f,
                                -7.8631e-01f, -6.0122e-02f, -7.3115e-01f,  3.1904e-01f, -1.7724e+00f,
                                3.4493e-01f,  1.2435e+00f,  2.0885e-01f,  3.7941e+00f, -4.1437e-01f,
                                1.2821e-01f,  8.5865e-02f,  2.2690e-01f, -9.3722e-01f, -8.3032e-01f,
                                1.5093e+00f,  1.1380e+00f, -9.5295e-01f, -5.0601e-01f,  3.9493e-01f,
                                1.1346e+00f,  5.0670e-02f, -3.2213e-01f,  8.3160e-02f,  8.8817e-02f,
                                5.4741e-01f, -1.2938e+00f,  4.7175e-01f,  2.9466e-01f,  1.3618e+00f,
                                -6.7830e+00f},
                        {-2.1514e+00f, -3.2475e+00f, -3.1716e+00f,  3.7687e+00f, -1.0859e+00f,
                                -2.2011e+00f,  5.3428e+00f,  2.4360e-01f, -1.6649e+00f,  3.1344e-01f,
                                7.7259e-01f, -3.7354e+00f,  8.0534e-01f,  2.6382e+00f,  2.0334e+00f,
                                5.8857e+00f,  1.5617e-01f, -9.0557e-02f,  4.8223e-01f, -2.5562e+00f,
                                -6.9153e-01f,  8.8101e-02f,  1.3075e+00f, -2.5241e+00f,  5.1388e-01f,
                                1.3594e+00f, -1.4674e+00f,  4.1220e-01f, -1.0166e+00f, -1.5417e+00f,
                                1.5049e-01f, -1.2695e+00f, -9.0183e-01f,  1.9588e+00f,  1.0125e+00f,
                                -1.6850e+00f, -1.6379e+00f, -7.6576e-01f, -1.6694e+00f,  4.6501e-01f,
                                -4.2948e-01f,  1.1687e+00f, -4.9567e+00f,  6.8620e-01f, -1.2456e-01f,
                                -1.1843e-01f,  2.1180e-01f, -3.5135e-01f, -1.4822e-01f, -5.2597e-01f,
                                -9.9175e-01f,  1.7684e+00f,  7.9190e-01f,  9.5999e-01f,  5.9997e-01f,
                                -3.7514e-01f, -1.4880e+00f,  4.5171e-01f, -1.0737e+00f,  3.4804e+00f,
                                -2.7035e+00f, -8.2079e-01f,  9.0082e-01f, -1.4329e+00f,  2.0348e+00f,
                                3.3525e+00f,  4.0804e-01f,  2.7541e-01f,  6.5912e-01f, -1.2381e+00f,
                                -5.2054e-01f,  1.2527e+00f, -6.8161e-01f, -2.3543e+00f,  2.8560e+00f,
                                3.5939e-01f,  8.0567e-01f,  8.1967e-01f, -1.3455e+00f, -3.2656e-01f,
                                -1.4747e+00f,  3.5406e-01f,  2.4275e+00f,  1.3849e+00f, -1.1155e+00f,
                                -3.8540e-01f,  1.4475e+00f, -2.6913e-01f, -7.7110e-01f, -6.6118e-01f,
                                -4.3154e-01f,  6.9654e-01f, -1.9373e-01f,  6.1319e-01f,  7.4034e-01f,
                                1.2803e+00f,  1.2480e+00f, -1.5312e+00f,  4.6957e-01f,  6.7513e-01f,
                                5.6870e-01f,  1.2471e+00f, -4.2672e-01f,  2.5187e+00f,  1.0406e+00f,
                                1.5659e+01f, -1.1820e+00f, -9.8103e-02f,  1.7988e-01f, -4.0072e-01f,
                                -1.8212e+00f,  2.0059e+00f,  3.9018e-01f, -2.5856e-02f, -5.9582e-01f,
                                1.6167e-01f,  4.5767e-01f,  1.4713e+00f,  1.8947e-01f,  1.6357e+00f,
                                5.3811e-01f,  2.8339e+00f,  7.1094e-02f, -1.2105e+00f, -6.5152e-01f,
                                2.7702e+00f,  1.4248e+00f, -2.0926e+00f,  4.0891e+00f,  4.8822e+00f,
                                7.3673e-01f,  5.1572e+00f, -3.1833e+00f,  1.3264e+00f,  1.6515e+00f,
                                2.6640e-01f, -3.6617e+00f,  3.5594e+00f,  9.7455e-01f, -1.1150e+00f,
                                -1.0819e+00f, -8.1960e-01f, -2.8626e+00f, -2.3778e+00f,  1.4893e-02f,
                                2.5286e+00f,  2.8382e+00f, -1.1514e-01f, -1.2828e+00f,  6.2303e-01f,
                                5.1145e-01f, -5.4426e+00f,  2.3587e+00f,  4.6096e+00f, -1.6256e+00f,
                                -1.8302e-01f,  1.5034e+00f,  1.1181e+00f,  1.6136e+00f, -4.6128e+00f,
                                2.4139e+00f,  1.1227e-02f, -1.1591e+00f, -1.2497e-01f,  2.0804e+00f,
                                -1.5378e+00f,  1.6241e+00f, -1.9569e+00f, -1.6472e+00f,  2.0895e+00f,
                                6.8495e-01f, -2.2030e+00f,  2.0701e+00f,  1.5323e+00f,  5.8515e-01f,
                                -1.0857e+00f, -9.0555e-02f, -2.3759e+00f,  6.9333e-01f,  7.4174e-01f,
                                3.7141e+00f, -2.6538e+00f,  7.3543e-01f, -2.9849e-01f, -5.1531e-01f,
                                -3.7616e-01f,  7.0572e-01f, -4.3533e-01f, -2.3057e+00f, -8.8209e-01f,
                                7.9649e-01f, -4.7639e-02f,  1.1422e+00f, -1.2977e+00f, -3.7885e+00f,
                                1.2269e+00f, -1.9795e+00f,  2.6552e-01f, -2.7989e+00f, -2.2255e+00f,
                                -3.0616e-01f,  1.5367e+00f,  1.9361e+00f,  1.8075e+00f,  5.4057e-01f,
                                8.4398e-02f,  7.5655e+00f,  7.9661e-01f,  9.3234e-01f,  8.0825e-01f,
                                2.7035e-01f,  1.8836e+00f, -6.2672e-02f, -2.5502e+00f,  3.1940e+00f,
                                -2.1958e-01f,  7.5530e-01f,  5.3861e-01f, -1.8178e-01f,  8.7152e-01f,
                                -2.7712e+00f, -9.1385e-01f, -5.9782e-01f, -8.6084e-01f,  8.3162e-01f,
                                1.5876e+00f, -1.2704e+00f, -3.1859e-01f,  7.7225e-01f, -1.4308e+00f,
                                -1.1959e+00f, -5.0399e-01f, -3.6814e-01f,  3.3642e+00f, -7.7994e-01f,
                                1.3886e+00f, -1.4393e+00f,  5.3730e-01f, -4.0103e-01f,  1.0102e+00f,
                                1.8016e+00f,  2.7344e-01f,  1.9573e+00f, -4.4596e-01f,  1.3542e+00f,
                                2.7939e-01f, -1.1344e-01f, -7.4547e-01f,  1.0812e+00f,  1.6725e+00f,
                                1.1461e+00f,  7.8153e-01f,  5.1536e-01f,  3.0263e-01f, -8.5927e-01f,
                                -7.0759e+00f}});
        
        var key = createMatrix(new float[][]

                {{-1.6443e+00f, -2.3831e-02f,  1.9685e+00f, -1.2213e+00f,  4.3034e-03f,
                        -1.3253e+00f, -1.5873e-01f, -4.7871e-01f,  4.6620e-01f, -5.8357e-01f,
                        5.3409e-01f,  4.7687e-01f,  2.3753e+00f,  1.5629e+00f,  1.5397e+00f,
                        -3.3070e-01f,  2.4237e-02f, -1.3741e+00f,  1.2136e+00f,  1.4087e+00f,
                        1.3759e-01f,  6.5277e-01f, -6.4992e-01f, -4.1858e-01f,  1.5381e-01f,
                        1.8778e+00f,  1.2944e+00f,  1.0114e+00f, -3.1293e-01f,  6.4818e-01f,
                        -7.8048e-01f,  3.8547e-01f, -2.5458e-01f,  2.8727e-01f, -1.5551e-01f,
                        4.1153e-01f, -3.8955e-02f,  1.4120e+00f,  7.5547e-01f,  1.3792e+00f,
                        -7.4472e-01f,  2.5891e-01f, -2.8128e+00f, -3.8309e-01f, -7.4505e-01f,
                        -5.3512e-02f, -7.3638e-01f, -8.9536e-01f,  1.3795e+00f, -1.4344e+00f,
                        7.4205e-01f,  5.1297e-01f,  8.7693e-01f, -2.5072e-01f,  6.7098e-01f,
                        -1.8160e-01f, -2.1887e+00f, -2.8796e-01f, -1.6310e+00f, -4.5237e-01f,
                        -8.7065e-01f,  6.0545e-01f,  2.6158e+00f, -7.7219e-01f,  6.7500e-01f,
                        -1.0601e+00f,  1.5683e+00f,  1.7056e-01f, -1.0623e+00f, -7.7479e-01f,
                        3.1110e-01f,  6.9669e-01f, -4.3933e-01f,  4.0869e-01f, -3.3426e-01f,
                        -7.3792e-02f, -2.2260e-01f,  5.2835e-01f,  4.4509e+00f, -5.3706e-01f,
                        2.2535e-01f, -3.6723e-01f, -1.5298e-01f, -9.2687e-01f, -1.8864e+00f,
                        -2.8678e+00f,  2.4291e+00f, -6.3801e-01f,  1.2762e+00f,  1.3542e+00f,
                        -1.8105e+00f, -1.0462e+00f,  1.7912e+00f, -1.4978e+00f, -6.6596e-01f,
                        -1.2633e+00f, -7.6014e-01f, -2.8255e-01f,  1.7769e+00f,  3.3241e-01f,
                        2.7165e-01f, -9.1364e-01f,  1.3617e+00f,  4.3297e-01f,  9.2852e-01f,
                        -2.5759e+00f,  1.5965e+00f, -1.4540e+00f, -1.2735e+00f,  1.9389e-01f,
                        -9.7052e-01f,  4.0612e-01f, -6.8582e-01f, -3.4291e-01f, -7.5106e-01f,
                        6.9970e-02f, -1.1769e-01f,  3.1299e-01f,  9.1490e-02f, -2.0244e-01f,
                        -1.1266e+00f,  9.1668e-01f,  1.8381e+00f, -8.2400e-01f, -3.9838e-02f,
                        2.5505e+00f, -2.5994e+00f, -8.6048e-02f, -3.5487e+00f,  8.3523e-01f,
                        -1.0535e+00f, -2.8883e-01f,  9.9158e-01f,  2.5532e-01f, -8.4502e-01f,
                        -2.9598e-01f,  1.6793e+00f,  3.0881e-02f,  3.3746e-01f, -2.3028e-01f,
                        3.9899e-01f,  3.6615e-01f, -6.8251e-01f, -1.1978e+00f,  1.2966e+00f,
                        -8.8040e-01f,  8.8143e-01f,  6.9429e-03f,  1.3722e+00f, -9.2103e-02f,
                        8.0655e-01f,  3.2252e-03f, -3.1684e-01f, -2.4304e-01f, -2.0902e-01f,
                        -1.3195e-01f,  1.7423e+00f, -1.3497e+00f, -1.8133e+00f, -1.3680e+00f,
                        1.0768e+00f, -3.5973e-01f, -8.5623e-01f, -2.0373e+00f,  2.0375e+00f,
                        -1.5561e-01f, -2.0896e-01f, -5.6583e-01f,  1.8392e-01f,  7.2754e-01f,
                        3.7782e-01f, -1.4538e-01f,  1.3094e+00f, -9.5405e-01f,  6.3994e-01f,
                        -9.0269e-01f, -1.5733e+00f, -6.8402e-01f,  1.3427e+00f, -3.7570e-02f,
                        -6.7212e-01f, -1.0342e+00f, -2.1645e+00f, -2.4938e+00f, -1.9880e+00f,
                        9.9102e-01f, -1.6908e+00f, -7.1982e-01f,  1.3087e-01f, -8.6065e-01f,
                        1.8487e+00f, -2.6935e-01f, -3.0303e-01f,  3.8318e-01f, -9.1951e-01f,
                        6.1436e-01f,  1.5780e+00f,  2.9396e-01f, -3.8679e-01f,  9.0587e-01f,
                        -1.2991e+00f,  5.8839e-01f,  8.7568e-01f,  6.6391e-01f, -6.0364e-01f,
                        7.5291e-01f,  1.2781e+00f, -2.9043e-02f, -3.3836e-01f,  3.7234e-01f,
                        6.2155e-01f, -2.9285e-01f,  8.2700e-01f,  9.5847e-01f, -4.1524e-01f,
                        2.3737e+00f, -2.4829e+00f,  5.6489e-01f,  2.1734e-01f,  3.9478e-01f,
                        -1.7367e+00f,  3.1726e-01f, -1.6442e+00f,  9.4882e-01f,  3.7492e-01f,
                        1.2129e+00f, -2.1247e-01f, -1.0820e+00f, -2.2299e+00f,  1.0772e+00f,
                        2.1464e-01f,  6.8573e-01f,  9.5771e-01f, -1.0481e+01f,  7.5508e-01f,
                        -3.9343e-01f, -4.8253e-01f,  5.7874e-01f, -3.3757e-01f,  2.7780e+00f,
                        1.3322e-01f, -1.8763e-01f, -5.2969e-01f, -2.1821e-01f, -1.0946e+00f,
                        -1.0859e+00f,  8.6433e-01f, -1.7909e+00f,  7.6392e-01f, -2.4013e+00f,
                        -8.6265e-01f,  1.4210e+00f, -5.6308e-01f, -1.8412e+00f,  3.8800e-01f,
                        6.5318e-01f},
                        { 4.6738e+00f,  2.6050e+00f,  4.6571e-01f,  8.9890e-01f, -1.2433e-01f,
                                1.1390e+00f,  2.0227e+00f, -2.9008e-01f, -2.1279e+00f,  9.5295e-01f,
                                3.7334e-02f, -1.8163e+00f, -2.2453e-01f, -2.7093e-01f,  2.7507e-01f,
                                2.1270e+00f, -5.4489e-02f, -6.1798e-01f,  1.8767e+00f,  7.0628e-01f,
                                7.3588e-02f,  1.9673e+00f,  3.8331e-01f, -1.9507e+00f, -1.4100e-01f,
                                1.8474e+00f, -3.2161e-01f,  5.2039e-01f, -7.0227e-01f,  6.5497e-01f,
                                4.8974e-02f, -7.6081e-02f, -4.1429e-02f,  1.3522e+00f,  2.1294e-01f,
                                3.4499e-01f, -7.9100e-02f,  4.5008e-01f,  3.7958e-01f,  5.2142e-02f,
                                -1.4732e-01f, -3.3107e-01f, -2.6012e+00f, -2.5168e-01f, -2.4842e-01f,
                                4.7031e-01f, -1.3180e+00f, -4.2469e-02f,  9.3930e-02f, -2.6680e-01f,
                                -9.0138e-01f, -7.4245e-01f, -8.3093e-01f,  8.0401e-01f,  3.7912e-01f,
                                -8.3440e-01f, -4.7341e-02f,  1.2069e+00f,  2.9792e-01f, -6.1594e-01f,
                                6.6564e-01f, -4.7258e-01f,  9.8436e-01f,  2.7355e-01f, -1.4347e+00f,
                                9.7239e-01f,  1.8112e-01f, -8.9671e-01f, -1.2804e+00f, -5.8479e-01f,
                                1.0309e+00f, -1.6302e-01f,  5.9978e-01f,  6.8084e-01f,  1.4193e-01f,
                                5.7795e-01f,  7.7567e-02f,  1.1905e+00f,  4.3048e+00f,  5.5710e-01f,
                                6.4714e-01f,  1.3700e-01f,  2.2560e-01f, -9.0522e-01f, -2.6173e-01f,
                                7.2810e-01f,  5.2883e-01f,  4.3896e-01f, -8.9099e-01f, -6.5772e-01f,
                                4.6540e-01f,  1.6392e-01f, -7.0410e-01f,  4.3364e-01f, -1.9745e-01f,
                                -7.5244e-01f,  4.3678e-01f, -1.4146e+00f, -1.2204e-01f,  4.3499e-01f,
                                1.4367e-01f, -5.5857e-01f, -4.7526e-01f,  1.1013e-02f, -2.0938e-01f,
                                -2.4853e+00f,  1.5847e-01f, -1.6906e-01f,  6.7988e-01f,  1.9593e-01f,
                                -3.3021e-01f,  1.5752e+00f,  1.1543e+00f, -2.5238e-01f,  1.5551e+00f,
                                1.1270e+00f, -9.5837e-01f, -4.7984e-01f,  2.9356e-01f,  4.6850e-01f,
                                4.5341e-01f,  3.0873e-01f, -5.2381e-01f, -9.7384e-02f, -1.7213e-01f,
                                7.9682e-01f, -3.7497e-01f, -2.0118e+00f, -4.2181e+00f,  4.2992e-01f,
                                1.3535e+00f, -3.3127e+00f,  1.6805e+00f, -7.3200e-01f, -8.1612e-01f,
                                -5.8052e-02f,  9.8109e-01f,  2.3233e+00f,  5.9701e-01f,  1.5159e+00f,
                                1.2903e+00f,  5.7716e-01f, -8.4008e-01f, -1.5823e+00f, -1.1183e-02f,
                                -5.9069e-01f,  1.1749e+00f,  2.5641e-01f,  5.5541e-01f,  5.4442e-01f,
                                7.4227e-02f, -1.8748e+00f,  2.0270e-01f,  1.4744e+00f, -6.6106e-01f,
                                1.8939e-01f,  4.1841e-02f, -4.7648e-01f,  4.1967e-01f, -1.8820e+00f,
                                -4.6068e-01f, -6.5836e-01f,  2.5121e-01f,  4.8159e-01f,  1.6912e+00f,
                                -1.7255e-01f,  2.4202e-01f, -6.7361e-01f, -2.7820e-01f, -2.6704e-01f,
                                -2.0363e-01f,  1.5257e+00f, -6.7852e-01f, -8.5866e-02f,  4.2277e-01f,
                                -3.4090e-01f,  3.7178e-01f, -7.9938e-02f,  2.3800e-01f,  1.2715e-01f,
                                -2.3536e-01f, -4.5018e-01f,  4.8628e-01f,  2.5279e-01f,  4.2191e-01f,
                                3.8000e-01f,  7.1731e-01f,  1.3524e-02f,  8.3971e-01f, -1.3871e-02f,
                                1.0598e+00f,  4.3122e-01f, -1.0842e+00f, -7.2459e-01f,  5.2654e-01f,
                                -3.2216e-02f, -7.9201e-02f,  5.3264e-01f,  2.1219e-01f,  1.6158e-01f,
                                -9.2262e-02f,  5.4037e-01f,  2.9360e-01f, -2.2191e+00f,  2.2219e-01f,
                                1.7284e-03f,  3.5433e-01f,  1.7690e-01f,  5.9201e-01f, -3.5745e-01f,
                                -1.2781e+00f, -6.9181e-01f, -1.3522e+00f, -5.5315e-01f,  3.6820e-01f,
                                -4.9559e-01f,  2.6644e-02f, -1.5700e-01f, -3.9719e-01f, -1.6165e+00f,
                                1.8357e+00f,  4.0057e-01f,  1.9985e+00f,  3.8379e-01f,  8.4111e-01f,
                                -4.1001e-01f,  1.0308e+00f,  4.1730e-01f, -3.0676e-01f,  4.9778e-01f,
                                5.9080e-01f,  1.5551e+00f, -2.5324e-01f, -1.0708e+01f, -7.8408e-01f,
                                -7.5935e-01f,  5.8951e-01f, -1.1136e+00f, -2.3992e-02f,  9.6966e-01f,
                                -6.3229e-02f,  5.3941e-01f, -1.2858e+00f, -4.9960e-01f, -2.3768e-01f,
                                5.6765e-01f, -2.0756e+00f, -8.0534e-01f,  1.4911e+00f,  6.1166e-01f,
                                1.2601e+00f, -8.7156e-01f, -8.7505e-01f, -3.4948e+00f,  9.6713e-01f,
                                6.1537e+00f},
                        { 5.3689e+00f,  1.6913e+00f, -1.4466e+00f,  1.8811e+00f, -8.2780e-01f,
                                1.0027e+00f,  2.5751e+00f, -1.1583e+00f, -1.7923e+00f,  7.0559e-01f,
                                -3.6890e-01f, -9.5282e-01f,  4.6145e-01f, -2.4238e-01f,  4.7919e-01f,
                                2.0674e+00f, -2.0446e-01f,  6.2970e-01f,  1.5773e+00f,  9.6323e-01f,
                                1.4025e+00f,  1.5630e+00f, -2.0737e-01f, -1.2106e+00f, -5.7113e-01f,
                                1.2191e+00f, -1.1730e+00f,  1.9018e+00f, -1.0887e+00f, -1.5346e-01f,
                                -6.6023e-03f,  4.7278e-01f,  1.6310e-01f, -6.8340e-01f,  3.2344e-01f,
                                -1.2568e-01f, -5.9547e-01f,  2.8290e-01f,  5.9522e-01f, -2.4574e-01f,
                                -5.2588e-01f, -1.2358e-01f, -1.9677e+00f, -3.1791e-01f,  2.0866e-02f,
                                -3.1437e-01f, -8.2491e-01f, -3.1405e-01f,  8.3268e-01f,  3.8799e-01f,
                                -6.3618e-02f, -1.4753e+00f, -4.1516e-01f, -7.6170e-01f, -6.4498e-01f,
                                3.5991e-01f, -6.1698e-01f,  1.5697e-01f,  4.4892e-01f,  8.1344e-01f,
                                1.7016e-01f,  8.4897e-01f,  1.4126e+00f, -9.9120e-01f, -1.0309e+00f,
                                -2.2183e-01f, -5.4560e-01f, -2.0640e-01f,  9.4110e-02f,  1.7950e-02f,
                                2.9797e-01f,  7.1506e-02f,  1.5489e+00f,  5.1007e-01f, -1.3892e-01f,
                                -1.0531e-02f, -2.9574e-01f,  6.6112e-02f,  3.1010e+00f,  4.7385e-01f,
                                -4.1930e-02f,  4.6643e-01f, -9.7187e-01f, -6.1092e-02f,  8.2649e-01f,
                                2.0126e-01f,  9.4442e-01f,  3.1823e-02f,  6.2480e-01f,  5.2531e-01f,
                                4.2966e-01f, -1.4750e+00f,  1.2351e-01f,  1.9761e-02f,  9.2699e-01f,
                                -1.5347e+00f,  8.5281e-01f, -1.7970e-01f, -2.1041e-01f,  4.5272e-01f,
                                4.5811e-02f, -7.1085e-01f,  3.7468e-01f, -1.1260e+00f, -3.0915e-01f,
                                -2.5210e+00f,  1.8775e-01f, -1.2990e+00f,  1.0525e+00f,  1.4177e+00f,
                                4.0393e-01f,  1.3734e+00f,  1.3595e+00f, -5.4453e-01f, -5.3249e-01f,
                                -5.6642e-02f, -9.3625e-01f, -8.7343e-02f,  7.7768e-02f,  1.8119e+00f,
                                6.4830e-01f, -1.0091e+00f, -4.9088e-02f, -4.8696e-02f,  2.2661e-01f,
                                1.3325e+00f,  3.5044e-01f, -4.0109e-01f,  2.0707e+00f,  2.5275e+00f,
                                1.5654e+00f, -1.2281e+00f,  6.8913e-01f, -5.4198e-01f,  4.2619e-01f,
                                3.6367e-01f, -8.0329e-01f,  2.0885e+00f,  2.7518e-01f, -3.4514e-01f,
                                1.6557e+00f,  7.4692e-01f, -2.9769e-01f, -2.7628e-01f,  7.8771e-01f,
                                4.9483e-01f,  9.9697e-01f,  8.0868e-01f, -2.1330e-01f,  1.0392e+00f,
                                1.5560e+00f, -1.3148e+00f,  1.7762e-01f,  5.8453e-01f,  8.2349e-01f,
                                -3.6638e-01f,  6.2459e-01f, -4.2418e-01f, -1.4142e-01f, -1.5552e+00f,
                                -4.9285e-01f, -1.9780e-01f, -5.7590e-01f, -8.8911e-01f,  1.4940e+00f,
                                -7.9251e-01f,  1.1313e-01f,  4.9275e-01f,  8.8300e-01f,  7.9355e-01f,
                                -7.9900e-01f,  3.7667e-01f, -3.9588e-01f, -3.1997e-01f, -1.4323e-01f,
                                5.4172e-01f, -8.6001e-01f, -1.0384e+00f,  9.5034e-01f,  3.1809e-01f,
                                -2.2913e-01f,  5.4526e-01f,  4.6730e-02f, -1.5407e+00f, -5.8570e-01f,
                                -5.8396e-01f,  1.8182e-01f, -1.8900e-01f, -2.3184e-01f, -4.1899e-03f,
                                1.9298e+00f,  8.1607e-01f,  5.1831e-01f, -3.8129e-01f, -2.3653e-01f,
                                4.5344e-01f, -1.3124e+00f,  2.4816e-01f, -1.0081e+00f, -1.5883e-01f,
                                -2.3464e-01f, -4.1332e-01f,  9.9424e-01f, -5.1662e-01f, -1.1200e+00f,
                                1.5669e-01f,  6.2224e-01f,  2.8532e-01f, -1.3025e-01f,  2.2743e-01f,
                                -1.4121e+00f,  6.7991e-01f, -7.3474e-01f, -2.1584e-01f, -4.9022e-01f,
                                6.8294e-01f,  1.4971e+00f, -1.4447e+00f, -2.5167e-02f,  8.4192e-01f,
                                -8.7673e-01f,  1.6426e+00f,  8.9707e-01f,  5.5847e-01f,  1.4320e-02f,
                                7.1938e-01f, -9.2055e-03f,  6.2379e-02f,  6.1232e-01f,  1.4601e+00f,
                                -6.9126e-01f,  1.2286e+00f, -1.0181e-01f, -9.6814e+00f,  5.4749e-01f,
                                -3.8430e-01f,  5.6709e-02f, -1.5741e-01f, -3.8647e-01f, -6.8331e-01f,
                                3.5109e-01f, -3.4601e-01f,  2.3637e-01f,  2.9617e-01f,  8.0246e-01f,
                                6.8300e-01f, -3.3033e+00f, -1.1512e+00f,  1.9801e+00f,  1.4854e+00f,
                                1.8704e+00f, -3.9443e-01f, -6.4461e-01f, -2.1727e+00f,  3.5279e-01f,
                                5.4274e+00f},
                        { 1.1584e+00f, -1.0166e+00f, -2.1297e+00f,  2.1886e+00f, -1.0754e+00f,
                                1.1166e+00f,  1.7932e+00f, -1.1598e+00f, -1.0880e+00f, -4.3253e-01f,
                                -4.5478e-01f, -7.0555e-01f, -2.5669e-01f, -5.0960e-01f,  5.5390e-01f,
                                2.0413e+00f, -4.3928e-01f,  4.5911e-01f,  1.2489e+00f,  7.2827e-01f,
                                1.4133e+00f,  1.2977e+00f, -5.2030e-01f, -9.3888e-01f, -5.9355e-01f,
                                1.1062e+00f, -1.2854e+00f,  1.9347e+00f, -1.1621e+00f, -9.9775e-02f,
                                9.7368e-03f,  6.3686e-01f,  2.1148e-01f, -6.6207e-01f,  3.7204e-01f,
                                -5.3705e-02f, -7.0572e-01f,  3.3747e-01f,  5.8663e-01f, -2.7505e-01f,
                                -5.7468e-01f, -1.6491e-01f, -1.9265e+00f, -3.3465e-01f,  3.7536e-02f,
                                -3.0157e-01f, -8.1914e-01f, -3.3227e-01f,  8.5945e-01f,  4.1837e-01f,
                                -8.9615e-02f, -1.4829e+00f, -4.0961e-01f, -7.7354e-01f, -6.4581e-01f,
                                3.8929e-01f, -6.0647e-01f,  1.6661e-01f,  4.4606e-01f,  8.1606e-01f,
                                1.7324e-01f,  8.4896e-01f,  1.3902e+00f, -9.9992e-01f, -1.0360e+00f,
                                -2.1827e-01f, -5.4353e-01f, -2.1004e-01f,  1.0395e-01f,  1.6218e-02f,
                                3.0451e-01f,  7.2464e-02f,  1.5502e+00f,  5.1223e-01f, -1.4376e-01f,
                                -8.1896e-03f, -2.9102e-01f,  6.5496e-02f,  3.0987e+00f,  4.7288e-01f,
                                -4.1518e-02f,  4.6576e-01f, -9.6800e-01f, -6.2824e-02f,  8.2823e-01f,
                                2.0173e-01f,  9.4543e-01f,  3.0518e-02f,  6.2214e-01f,  5.2770e-01f,
                                4.2970e-01f, -1.4762e+00f,  1.2468e-01f,  1.7723e-02f,  9.2595e-01f,
                                -1.5353e+00f,  8.5279e-01f, -1.8037e-01f, -2.1040e-01f,  4.5267e-01f,
                                4.5352e-02f, -7.1187e-01f,  3.7513e-01f, -1.1268e+00f, -3.0909e-01f,
                                -2.5159e+00f,  1.8748e-01f, -1.2988e+00f,  1.0525e+00f,  1.4177e+00f,
                                4.0407e-01f,  1.3736e+00f,  1.3594e+00f, -5.4443e-01f, -5.3256e-01f,
                                -5.6717e-02f, -9.3644e-01f, -8.7494e-02f,  7.8447e-02f,  1.8121e+00f,
                                6.4795e-01f, -1.0094e+00f, -4.9376e-02f, -4.8640e-02f,  2.2669e-01f,
                                1.3328e+00f,  3.5040e-01f, -4.0168e-01f,  5.6366e+00f,  2.8663e+00f,
                                -8.7611e-02f,  5.0656e-01f, -5.9915e-02f,  2.2904e-01f,  1.8966e+00f,
                                -3.5887e-01f, -1.6352e+00f,  2.1616e+00f,  7.0567e-02f, -7.2746e-01f,
                                1.6996e+00f,  5.9745e-01f, -1.0694e-01f,  4.2863e-01f,  6.8507e-01f,
                                6.5620e-01f,  1.3864e+00f,  1.0254e+00f,  1.2214e-01f,  1.3561e+00f,
                                1.4810e+00f, -1.5209e+00f,  7.3790e-02f,  7.7737e-01f,  6.3383e-01f,
                                -9.1024e-02f,  4.7430e-01f, -4.3992e-01f, -1.4124e-01f, -1.4955e+00f,
                                -4.7410e-01f, -2.6045e-01f, -5.4576e-01f, -8.9634e-01f,  1.4451e+00f,
                                -7.7086e-01f,  1.5152e-01f,  4.7701e-01f,  8.5204e-01f,  7.8600e-01f,
                                -8.9384e-01f,  3.6188e-01f, -3.9465e-01f, -3.3206e-01f, -1.7325e-01f,
                                5.3073e-01f, -8.3326e-01f, -1.0265e+00f,  9.4824e-01f,  2.8040e-01f,
                                -2.3891e-01f,  5.2832e-01f,  3.3476e-02f, -1.5335e+00f, -5.9657e-01f,
                                -5.8128e-01f,  1.8871e-01f, -1.7733e-01f, -2.2955e-01f,  6.3453e-03f,
                                1.9460e+00f,  8.0537e-01f,  5.0797e-01f, -3.8334e-01f, -2.4124e-01f,
                                4.5177e-01f, -1.3117e+00f,  2.4828e-01f, -1.0061e+00f, -1.5839e-01f,
                                -2.2592e-01f, -4.1064e-01f,  9.9355e-01f, -5.1666e-01f, -1.1212e+00f,
                                1.5695e-01f,  6.3356e-01f,  2.8693e-01f, -1.3038e-01f,  2.2880e-01f,
                                -1.4148e+00f,  6.7976e-01f, -7.3277e-01f, -2.1539e-01f, -4.8828e-01f,
                                6.8300e-01f,  1.4982e+00f, -1.4438e+00f, -2.4505e-02f,  8.3981e-01f,
                                -8.7656e-01f,  1.6426e+00f,  8.9814e-01f,  5.5682e-01f,  1.5173e-02f,
                                7.1921e-01f, -9.3877e-03f,  6.2744e-02f,  6.1236e-01f,  1.4596e+00f,
                                -6.9102e-01f,  1.2279e+00f, -1.0198e-01f, -9.6827e+00f,  5.4758e-01f,
                                -3.8488e-01f,  5.7153e-02f, -1.5685e-01f, -3.8633e-01f, -6.8285e-01f,
                                3.5152e-01f, -3.4617e-01f,  2.3623e-01f,  2.9616e-01f,  8.0224e-01f,
                                6.8298e-01f, -3.3033e+00f, -1.1509e+00f,  1.9802e+00f,  1.4852e+00f,
                                1.8704e+00f, -3.9444e-01f, -6.4458e-01f, -2.1725e+00f,  3.5283e-01f,
                                5.4273e+00f},
                        {-4.7505e+00f, -1.4333e+00f, -2.1665e+00f, -4.7779e-01f, -4.3952e-01f,
                                3.4519e+00f,  1.1542e+00f,  7.4719e-01f,  4.2985e-01f, -2.5075e+00f,
                                6.6096e-02f, -1.9688e-01f,  6.9078e-01f,  1.4884e+00f,  6.4754e-01f,
                                1.7935e+00f, -4.9612e-01f, -1.2925e+00f,  5.1273e-01f,  1.7492e+00f,
                                -6.3171e-01f,  2.9212e+00f, -5.5713e-01f, -1.7327e+00f,  3.0014e-01f,
                                1.6458e+00f, -4.3662e-01f,  2.0876e+00f,  4.4035e-01f, -1.0702e+00f,
                                6.8821e-01f,  7.4216e-01f,  3.0064e-01f,  7.1596e-01f,  4.2554e-01f,
                                -8.7146e-01f, -1.4139e+00f, -1.2124e+00f,  4.2819e-01f,  1.0104e+00f,
                                -2.1009e-01f, -1.4218e+00f, -2.0299e+00f, -5.8253e-01f, -3.0372e-01f,
                                -4.0610e-01f, -5.7887e-01f, -3.2059e-01f, -2.2982e+00f,  6.6513e-01f,
                                1.8217e+00f, -7.4655e-01f,  2.0925e-01f, -2.1138e-01f,  4.0799e-01f,
                                -2.0708e-01f, -1.8832e+00f,  9.1691e-01f, -1.9106e-01f, -1.0622e+00f,
                                -1.0174e+00f,  1.0888e+00f,  4.9181e-01f,  2.2725e-01f, -7.7157e-02f,
                                6.8518e-01f,  1.0539e+00f, -1.2465e+00f, -9.4272e-01f, -1.2876e+00f,
                                -7.4732e-01f,  5.5599e-01f, -2.5639e-01f,  1.2898e-02f,  6.7490e-01f,
                                -7.7847e-01f, -8.0097e-02f,  8.1027e-02f,  3.2522e+00f,  5.2991e-01f,
                                4.6842e-01f, -2.4918e-01f, -3.7731e-01f,  6.7276e-01f,  1.3699e+00f,
                                4.9180e-01f,  1.2368e+00f, -9.1671e-01f,  1.2986e+00f,  8.8546e-01f,
                                -7.0423e-01f, -3.7421e-02f,  7.3237e-01f, -3.0641e-01f, -3.1717e-02f,
                                8.4760e-01f, -1.2794e-01f, -6.6501e-01f,  2.9868e+00f,  1.6327e+00f,
                                -3.4364e-01f,  3.3789e-02f, -4.3263e-01f, -4.7034e-01f, -1.6831e+00f,
                                -2.7429e+00f,  1.0491e-01f,  1.3341e+00f,  2.5128e+00f,  3.1560e-01f,
                                -1.8134e+00f,  4.3341e-01f,  9.8192e-01f,  1.2394e+00f, -5.0786e-01f,
                                1.4626e+00f, -9.4574e-02f, -1.6397e-01f,  3.7743e-01f,  1.3932e+00f,
                                1.8133e+00f, -1.0683e+00f, -9.4090e-01f, -2.0915e+00f, -4.2339e-01f,
                                2.3083e+00f, -6.5922e-01f, -1.3508e-01f,  3.9670e+00f, -3.7726e-01f,
                                -1.1193e+00f,  3.8847e+00f, -5.5597e-01f, -1.8433e+00f,  9.2943e-01f,
                                -7.1716e-01f, -1.9519e+00f,  1.4002e+00f,  1.7757e-01f, -1.3412e+00f,
                                -9.7181e-01f, -6.7255e-01f,  6.5669e-01f,  2.5826e-01f,  3.0981e-01f,
                                3.4228e-01f,  2.1068e+00f, -6.2296e-01f, -3.0499e-01f,  1.6452e+00f,
                                7.1886e-01f, -1.6330e+00f, -4.4231e-01f,  1.0221e+00f, -5.8131e-01f,
                                1.1613e+00f, -1.0760e+00f, -5.9210e-01f, -8.8471e-01f, -7.1596e-01f,
                                -9.2091e-01f,  1.3340e+00f, -4.1786e-01f,  6.7215e-01f,  2.0615e+00f,
                                -6.4917e-01f,  1.2002e+00f, -4.8070e-01f,  1.5649e+00f, -1.8886e+00f,
                                -1.1643e+00f,  1.2793e+00f,  2.6373e-02f,  4.3643e-03f,  9.5487e-01f,
                                -4.3879e-01f,  1.7908e-01f,  1.0900e+00f,  6.0360e-01f, -1.1286e+00f,
                                1.1707e-01f,  1.6316e+00f, -9.1942e-01f, -7.9840e-01f,  4.8245e-01f,
                                -1.8232e-01f, -1.4445e+00f, -1.1798e-01f, -4.2064e-01f, -1.0031e-01f,
                                7.8362e-01f, -1.4907e+00f, -8.4583e-01f, -1.4127e+00f,  4.8092e-01f,
                                1.1514e+00f, -4.2707e-01f, -4.5717e-01f,  5.3160e-01f, -7.8338e-01f,
                                -3.4257e-01f,  1.5329e-01f, -1.3694e-01f, -1.6468e+00f, -1.7581e+00f,
                                7.3336e-01f,  4.0746e-01f, -8.9123e-01f,  2.9592e-01f, -3.8600e-01f,
                                -6.0970e-01f, -1.0301e+00f, -2.0687e+00f, -8.5340e-01f, -8.6067e-01f,
                                2.2345e+00f, -1.5851e-01f, -8.2793e-01f,  7.2088e-01f, -4.8466e-01f,
                                1.2336e+00f, -5.3675e-01f, -1.7816e+00f,  3.3430e-01f, -9.9951e-01f,
                                3.5739e-02f, -1.4369e+00f, -1.0853e+00f, -6.6735e-01f, -6.3240e-01f,
                                -1.2094e-01f,  1.4732e+00f, -1.6632e+00f, -9.8587e+00f, -1.9186e-01f,
                                5.7827e-01f, -2.2095e-01f,  3.5620e-01f, -1.5831e+00f, -1.2847e+00f,
                                5.9691e-01f,  2.5432e-01f,  2.5182e+00f, -5.1537e-01f,  7.9090e-01f,
                                2.8837e-01f, -3.0009e-01f, -2.5100e-02f, -6.3891e-01f,  1.3174e+00f,
                                -1.3429e+00f,  7.4318e-01f, -4.1928e-01f, -1.2712e+00f, -1.2564e+00f,
                                5.8924e+00f}});

        Matrix attention = query.multiplyByTransposed(key);

        var a = attention;
    }

    @Test
    public void addVectorsTest()
    {
        var vector1 = createVector(1, 2, 3, 4);
        var vector2 = createVector(4, 5, 6, 7);
        var expectedResult = new float[]{5, 7, 9, 11};

        assertVectorEquals(expectedResult, MATH.addVectors(vector1, vector2), 0);
    }

    @Test
    public void addMatricesTest()
    {
        var matrix1 = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var matrix2 = createMatrix(new float[][] {{11, 12, 13, 14}, {15, 16, 17, 18}});
        var expectedResult = new float[][] {{12, 14, 16, 18}, {20, 22, 24, 26}};

        assertMatrixEquals(expectedResult, MATH.addMatrices(matrix1, matrix2), 0);
    }

    @Test
    public void addBroadcastVectorTest()
    {
        var matrix = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var vector = createVector(11, 12, 13, 14);
        var expectedResult = new float[][] {{12, 14, 16, 18}, {16, 18, 20, 22}};

        assertMatrixEquals(expectedResult, MATH.addBroadcastVector(matrix, vector), 0);
    }

    @Test
    public void dotProductTest()
    {
        var vector1 = createVector(5, 6, 7, 8);
        var vector2 = createVector(4, 5, 6, 7);

        assertEquals(5*4 + 6*5 + 7*6 + 8*7, MATH.dotProduct(vector1, vector2), 0);
    }

    @Test
    public void mulVectorByScalarTest()
    {
        var vector = createVector(5, 6, 7, 8);
        var expectedResult = new float[]{15, 18, 21, 24};

        assertVectorEquals(expectedResult, MATH.mulVectorByScalar(vector, 3), 0);
    }

    @Test
    public void mulMatrixByScalar()
    {
        var matrix = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var expectedResult = new float[][] {{3, 6, 9, 12}, {15, 18, 21, 24}};

        assertMatrixEquals(expectedResult, MATH.mulMatrixByScalar(matrix, 3), 0);
    }

    @Test
    public void mulVectorByMatrixTest()
    {
        var vector = createVector(2, 5, 1, 8);
        var matrix = createMatrix(new float[][] {{1, 0, 2, 0}, {0, 3, 0, 4}, {0, 0, 5, 0}, {6, 0, 0, 7}});
        var expectedResult = new float[]{4, 47, 5, 68};

        assertVectorEquals(expectedResult, MATH.mulVectorByTransposedMatrix(vector, matrix), 0);
    }

    @Test
    public void mulVectorByTransposedMatrixTest()
    {
        var vector = createVector(5, 6, 7, 8);
        var matrix = createMatrix(new float[][] {{1, 4, 7, 10}, {2, 5, 8, 11}, {3, 6, 9, 12}});
        var expectedResult = new float[]{5 + 6*4 + 7*7 + 8*10, 5*2 + 6*5 + 7*8 + 8*11, 5*3 + 6*6 + 7*9 + 8*12};

        assertVectorEquals(expectedResult, MATH.mulVectorByTransposedMatrix(vector, matrix), 0);
    }

    @Test
    public void mulMatrixByMatrixTest()
    {
        var matrix1 = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var matrix2 = createMatrix(new float[][] {{11, 12}, {13, 14}, {15, 16}, {17, 18}});
        var expectedResult = new float[][] {
                {1*11 + 2*13 + 3*15 + 4*17, 1*12 + 2*14 + 3*16 + 4*18},
                {5*11 + 6*13 + 7*15 + 8*17, 5*12 + 6*14 + 7*16 + 8*18}};

        assertMatrixEquals(expectedResult, MATH.mulMatrixByMatrix(matrix1, matrix2), 0);
    }

    @Test
    public void mulMatrixByTransposedMatrixTest()
    {
        var matrix1 = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var matrix2 = createMatrix(new float[][] {{11, 13, 15, 17}, {12, 14, 16, 18}});
        var expectedResult = new float[][] {
                {1*11 + 2*13 + 3*15 + 4*17, 1*12 + 2*14 + 3*16 + 4*18},
                {5*11 + 6*13 + 7*15 + 8*17, 5*12 + 6*14 + 7*16 + 8*18}};

        assertMatrixEquals(expectedResult, MATH.mulMatrixByTransposedMatrix(matrix1, matrix2), 0);
    }

    @Test
    public void splitVectorTest()
    {
        var vector = createVector(1, 2, 3, 4, 5, 6);
        var expectedResult = new float[][]{{1, 2}, {3, 4}, {5, 6}};

        assertMatrixEquals(expectedResult, MATH.splitVector(vector, 3), 0);
    }

    @Test
    public void partitionVector()
    {
        var vector = createVector(1, 2, 3, 4, 5, 6);
        var expectedResult = new float[] {5, 6};

        assertVectorEquals(expectedResult, MATH.partitionVector(vector, 3, 2), 0);
    }

    @Test
    public void partitionMatrix()
    {
        var matrix = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var expectedResult = new float[][]{{3, 4}, {7, 8}};

        assertMatrixEquals(expectedResult, MATH.partitionMatrix(matrix, 2, 1), 0);
    }

    @Test
    public void joinVectors()
    {
        var vector1 = createVector(1, 2, 3, 4, 5, 6);
        var vector2 = createVector(7, 8, 9);
        var expectedResult = new float[] {1, 2, 3, 4, 5, 6, 7, 8, 9};

        assertVectorEquals(expectedResult, MATH.joinVectors(vector1, vector2), 0);
    }

    @Test
    public void flattenMatrixTest()
    {
        var vector1 = createVector(1, 2);
        var vector2 = createVector(3, 4);
        var vector3 = createVector(5, 6);

        var matrix = emptyMatrix(MatrixType.VECTOR_ARRAY_FLOAT_32, 3, 2);
        matrix.setRow(0, vector1);
        matrix.setRow(1, vector2);
        matrix.setRow(2, vector3);

        var expectedResult = new float[]{1, 2, 3, 4, 5, 6};

        assertVectorEquals(expectedResult, MATH.flattenMatrix(matrix), 0);
    }

    @Test
    public void joinMatrices()
    {
        var matrix1 = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var matrix2 = createMatrix(new float[][] {{11, 13, 15, 17}, {12, 14, 16, 18}});
        var expectedResult = new float[][]{{1, 2, 3, 4, 11, 13, 15, 17}, {5, 6, 7, 8, 12, 14, 16, 18}};

        assertMatrixEquals(expectedResult, MATH.joinMatrices(List.of(matrix1, matrix2)), 0);
    }

    @Test
    public void transposeMatrix()
    {
        var matrix = createMatrix(new float[][] {{1, 2, 3, 4}, {5, 6, 7, 8}});
        var expectedResult = new float[][]{{1, 5}, {2, 6}, {3, 7}, {4, 8}};

        assertMatrixEquals(expectedResult, MATH.transposeMatrix(matrix), 0);
    }

    @Test
    public void applyCausalMask()
    {
        var matrix = createMatrix(new float[][] {
                {1, 2, 3, 4},
                {5, 6, 7, 8},
                {9, 10, 11, 12},
                {13, 14, 15, 16}});

        var X = Float.NEGATIVE_INFINITY;

        var expectedResult = new float[][] {
                {1, X, X, X},
                {5, 6, X, X},
                {9, 10, 11, X},
                {13, 14, 15, 16}};

        MATH.applyCausalMask(matrix);

        assertMatrixEquals(expectedResult, matrix, 0);
    }

    @Test
    public void averageTest()
    {
        var vector = createVector(1, 2, 3, 4, 5, 6);

        assertEquals(3.5f, MATH.average(vector), 0);
    }
}
